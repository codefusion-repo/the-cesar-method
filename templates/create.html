{% extends "frases/base.html" %}
{% block title %}Nueva frase{% endblock %}
{% block content %}
<h2>Nueva frase</h2>
<form method="post">{% csrf_token %}
  <label>TÃ­tulo</label>
  {{ form.title }}
  <label>Frase</label>
  {{ form.plaintext }}
  <div class="muted">Inserta emojis:</div>
  <div class="emoji-grid" id="emoji-grid">
    <!-- mismo set que en utils.EMOJIS -->
    <button type="button" class="emoji-btn">ğŸ˜€</button>
    <button type="button" class="emoji-btn">ğŸ˜</button>
    <button type="button" class="emoji-btn">ğŸ˜‚</button>
    <button type="button" class="emoji-btn">ğŸ¤£</button>
    <button type="button" class="emoji-btn">ğŸ˜Š</button>
    <button type="button" class="emoji-btn">ğŸ˜</button>
    <button type="button" class="emoji-btn">ğŸ¤”</button>
    <button type="button" class="emoji-btn">ğŸ‘</button>
    <button type="button" class="emoji-btn">ğŸ‘</button>
    <button type="button" class="emoji-btn">ğŸ”¥</button>
    <button type="button" class="emoji-btn">ğŸ’¡</button>
    <button type="button" class="emoji-btn">âœ…</button>
    <button type="button" class="emoji-btn">âŒ</button>
    <button type="button" class="emoji-btn">â¤ï¸</button>
    <button type="button" class="emoji-btn">ğŸ¥³</button>
    <button type="button" class="emoji-btn">ğŸ˜­</button>
    <button type="button" class="emoji-btn">ğŸ˜¡</button>
    <button type="button" class="emoji-btn">ğŸ‡¨ğŸ‡±</button>
    <button type="button" class="emoji-btn">ğŸš€</button>
  </div>
  <label>Palabra mÃ¡gica</label>
  {{ form.passphrase }}
  <br><br><button class="btn" type="submit">Guardar cifrada</button>
</form>

<script>
const area = document.getElementById("id_plaintext");
document.querySelectorAll(".emoji-btn").forEach(btn=>{
  btn.addEventListener("click", ()=>{
    const start = area.selectionStart, end = area.selectionEnd;
    const before = area.value.slice(0, start);
    const after  = area.value.slice(end);
    area.value = before + btn.textContent + after;
    const pos = start + btn.textContent.length;
    area.setSelectionRange(pos, pos);
    area.focus();
  });
});
</script>
{% endblock %}