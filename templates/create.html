{% extends "base.html" %} {% block title %}Nueva frase{% endblock %} {% block content %}
<h2>Nueva frase</h2>
<!-- Formulario principal para registrar una nueva frase cifrada -->
<form method="post">
  {% csrf_token %}
  <label>Pista</label>
  {{ form.clue }}
  <label>Frase</label>
  {{ form.text }}
  <div class="muted">Inserta emojis:</div>
  <div class="emoji-grid" id="emoji-grid">
    <!-- mismo set que en utils.EMOJIS -->
    <button type="button" class="emoji-btn">😀</button>
    <button type="button" class="emoji-btn">😁</button>
    <button type="button" class="emoji-btn">😂</button>
    <button type="button" class="emoji-btn">🤣</button>
    <button type="button" class="emoji-btn">😊</button>
    <button type="button" class="emoji-btn">😍</button>
    <button type="button" class="emoji-btn">🤔</button>
    <button type="button" class="emoji-btn">👍</button>
    <button type="button" class="emoji-btn">👎</button>
    <button type="button" class="emoji-btn">🔥</button>
    <button type="button" class="emoji-btn">💡</button>
    <button type="button" class="emoji-btn">✅</button>
    <button type="button" class="emoji-btn">❌</button>
    <button type="button" class="emoji-btn">❤️</button>
    <button type="button" class="emoji-btn">🥳</button>
    <button type="button" class="emoji-btn">😭</button>
    <button type="button" class="emoji-btn">😡</button>
    <button type="button" class="emoji-btn">🇨🇱</button>
    <button type="button" class="emoji-btn">🚀</button>
  </div>
  <label>Palabra mágica (Contraseña)</label>
  {{ form.password }}
  <br /><br /><button class="btn" type="submit">Guardar cifrada</button>
</form>

<!-- Script ligero para insertar emojis en la posicion del cursor -->
<script>
  const area = document.getElementById("id_text");
  document.querySelectorAll(".emoji-btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      const start = area.selectionStart,
        end = area.selectionEnd;
      const before = area.value.slice(0, start);
      const after = area.value.slice(end);
      area.value = before + btn.textContent + after;
      const pos = start + btn.textContent.length;
      area.setSelectionRange(pos, pos);
      area.focus();
    });
  });
</script>
{% endblock %}
